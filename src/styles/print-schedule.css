@media print {
  @page {
    size: A4 landscape;
    margin: 10mm;
  }
  
  /* Nascondi tutto tranne il planner */
  body * {
    visibility: hidden;
  }
  
  #schedule-planner,
  #schedule-planner * {
    visibility: visible !important;
  }
  
  #schedule-planner {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    background: white !important;
    page-break-inside: avoid;
    max-height: none !important;
    overflow: visible !important;
  }
  
  /* Header compatto per stampa */
  #schedule-planner h1 {
    font-size: 18px !important;
    margin-bottom: 8px !important;
  }
  
  #schedule-planner p {
    font-size: 10px !important;
  }
  
  #schedule-planner img {
    height: 50px !important;
    width: auto !important;
    margin-bottom: 8px !important;
  }
  
  /* Mostra header con logo per stampa */
  .no-print-hide {
    display: block !important;
  }
  
  /* Nascondi tutti gli elementi UI */
  .no-print,
  button,
  nav,
  header,
  footer,
  .floating-cta,
  aside,
  [role="dialog"],
  .dialog-trigger,
  .edit-button,
  .delete-button {
    display: none !important;
    visibility: hidden !important;
  }
  
  /* Ottimizza il grid per stampa - scala a 85% */
  .schedule-grid {
    border-collapse: collapse;
    width: 100%;
    transform-origin: top left;
    transform: scale(0.85);
  }
  
  /* Grid headers compatti */
  .schedule-grid > div:first-child > div {
    font-size: 11px !important;
    padding: 4px !important;
  }
  
  /* Orari laterali compatti */
  .schedule-grid > div > div:first-child {
    font-size: 10px !important;
  }
  
  /* Celle schedule compatte */
  .schedule-cell,
  .schedule-grid > div > div {
    padding: 3px !important;
    min-height: 35px !important;
  }
  
  /* Card più compatte */
  .schedule-grid [class*="Card"] {
    border: 1.5px solid !important;
    page-break-inside: avoid;
    min-height: 35px !important;
  }
  
  .schedule-grid [class*="CardContent"] {
    padding: 3px !important;
  }
  
  /* Badge compatti */
  .schedule-grid [class*="Badge"] {
    font-size: 9px !important;
    padding: 2px 6px !important;
    white-space: nowrap !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  /* Nascondi pulsanti edit/delete nelle card */
  .schedule-grid button,
  .schedule-grid [class*="Button"] {
    display: none !important;
  }
  
  /* Migliora leggibilità testo */
  body {
    background: white !important;
    color: black !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
  
  /* Assicura che i colori delle card siano visibili */
  [style*="background-color"],
  [style*="backgroundColor"] {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  
  /* Font più leggibile per stampa */
  * {
    font-family: 'Arial', sans-serif !important;
  }
  
  /* Forza visualizzazione badge e icone */
  .schedule-grid svg {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
}
